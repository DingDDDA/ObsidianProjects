### 介绍
介绍了什么是图像修复
图像修复的应用
两种方法  使用特征块补丁和深度卷积网络优缺点
提出门控卷积用于不规则掩码的图像修复
    使用输入特征计算门控值
$$
    g = σ(wg *x)
$$
     输出：学习到的特征×门控值
$$
 y = φ(wx)
$$
介绍 SN-PatchGAN及该方法贡献

### 相关工作
###### 自动图像修复
相关研究及作者提出的端到端的图像修复模型 大型矩形掩码
部分卷积——不规则掩码
###### 用户指导图像修复与合成
丛数据库中搜索与输入图像最相似的示例图像，从中剪切粘贴相应区域
###### 特征级门控
相关研究

### 方法
本节自底向上描述
先介绍门控卷积、SN-PatchGAN的细节，再用表格展示修复网络的概述以及我们的扩展
###### 门控卷积
解释了原始传统卷积不适用于不规则的图像修补任务
给出的卷积公式
![[Pasted image 20240320160026.png]]
σ是Sigmoid函数，∅可以是任何激活函数
Wg和Wf是两种不同的卷积滤波器

**不同于部分卷积的硬门控掩码更新策略（掩膜部分是[0 1]二值模板），门控卷积是从数据数据中自动学习软掩码（掩膜部分是[0,1]中的连续值）。**

部分卷积与门控卷积对比
###### SN-PatchGAN
SN-PatchGAN的两个要素：PatchGAN和SN都是之前被提出过的
###### 修复网络体系结构
粗修复 把所有的常规卷积换成了门控卷积，输出模糊的初步结果
细修复 编码器分为两个平行分支：上路为上下文注意力机制分支和下路的常规分支 再合成一路进行解码 出精修复图
判别器 SN-PatchGAN
###### 自由掩码生成  损失函数
L1范数的重建损失：即预测结果和真值的L1距离。
hinge loss 对抗损失：
###### 用户指导
网络的输入包含一个用户交互的sketch通道，这样输入张量总共有5个通道（RGB+mask+sketch）
### 结果
###### 定量结果
中心孔和自由掩码的l1、l2误差
###### 定性比较
示例
###### 对象删除与创造性编辑
交互
###### 用户调查
###### SN PatchGAN的消融研究
### 结论
（1）引入门控卷积来学习所有层中每个空间位置的每个通道的动态特征选择机制，显著提高自由形式的蒙版和输入的颜色一致性和修复质量。

（2）提出来一种新颖的GAN鉴别器SN-PatchGAN。

（3）将提出的修复模型扩展为交互式模型，该模型可以将用户草图作为指导，以获得更多用户期望的修复结果。






训练网络时，输入是残缺图+mask+sketch，其中sketch由真值图通过HED边缘检测+阈值分割得到。  
输出端用重建损失+对抗损失去约束输出像真值靠近，计算对抗损失时，判别器的真样本是真值图+sketch，假样本是修复图+sketch。  
这样一来相当于sketch就变成了一个额外的条件约束，也就是网络必须按照sketch的指引修复图像，损失才能降到最低。
