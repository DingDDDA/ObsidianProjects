# 任务规划


还是之前的问题
开不了虚拟环境
[使用kaggle云服务器，如何更换python版本？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/421090639)
但是你这15天，才跑起来代码，还一点没改，数据集还没换，学长不会觉得你
```shell
!python --version
!conda create -n env_python_36 python=3.6 -y
!sudo rm /opt/conda/bin/python
!sudo rm /opt/conda/bin/python3
!sudo rm /opt/conda/bin/pip3
!sudo rm /opt/conda/bin/pip
!sudo ln -s /opt/conda/envs/env_python_36/bin/python3 /opt/conda/bin/python3
!sudo ln -s /opt/conda/envs/env_python_36/bin/python3 /opt/conda/bin/python
!sudo ln -s /opt/conda/envs/env_python_36/bin/pip /opt/conda/bin/pip
!sudo ln -s /opt/conda/envs/env_python_36/bin/pip /opt/conda/bin/pip3
!python --version

```

```python
import os
import sys
print(os.sys.path)
os.sys.path.insert(0, "/kaggle/working/native-generative")
sys.path.append('/kaggle/working/native-generative')
print(os.sys.path)
print(sys.path)
with open("write_python", 'w') as fw:
    fw.write("write python\n")
with open('inpaint.yml') as fr:
    lines = fr.readlines()
    print(lines)
```

上述这样修改之后需要python的系统路径可能没有添加当前的路径， 因此可能需要使用绝对路径来指定，或者将当前的系统路径添加到系统路径中

```shell
!pip install git+https://github.com/JiahuiYu/neuralgym
!pip install tensorflow==1.7.0
!pip install opencv-python==3.4.0.12
!pip install pyyaml==3.12
!pip install pillow==4.2.1
```

```shell
!cp ../../input/train-config/inpaint.yml inpaint.yml

```

```shell
!cd /kaggle/working && pwd && tree
!cp native-generative/inpaint_ops.py . -r
!cp native-generative/inpaint.yml . -r
!cp native-generative/train.py . -r
!cp native-generative/test.py . -r
!cp native-generative/batch_test.py . -r
!cp native-generative/guided_batch_test.py . -r
!cp native-generative/inpaint_model.py . -r
!cp native-generative/examples . -r
```

```shell
!cd /kaggle/working && pwd && tree
!python train.py
```

```python
# 将原数据集分为training ,validation  by gavin
import os
import random
 
import argparse
 
#划分验证集训练集
_NUM_TEST = 3
 
# parser = argparse.ArgumentParser()
# parser.add_argument('--folder_path', default='../input/celeba-dataset/img_align_celeba/img_align_celeba', type=str,
#                     help='The folder path')
# parser.add_argument('--train_filename', default='./data/celeba/train_shuffled.flist', type=str,
#                     help='The train filename.')
# parser.add_argument('--validation_filename', default='./data/celeba/validation_static_view.flist', type=str,
#                     help='The validation filename.')
 
folder_path = './examples/places2/'
train_filename = './data/places2/train_shuffled.flist'
validation_filename = './data/places/validation_static_view.flist'
    
 
def _get_filenames(dataset_dir):
    photo_filenames = []
    image_list = os.listdir(dataset_dir)
    photo_filenames = [os.path.join(dataset_dir, _) for _ in image_list]
    return photo_filenames
 
 
if __name__ == "__main__":
 
#     args = parser.parse_args()
 
#     data_dir = args.folder_path
    data_dir = folder_path
 
    # get all file names
    photo_filenames = _get_filenames(data_dir)
    print("size of celeba is %d" % (len(photo_filenames)))
 
    # 切分数据为测试训练集
    random.seed(0)
    random.shuffle(photo_filenames)
    training_file_names = photo_filenames[_NUM_TEST:]
    validation_file_names = photo_filenames[:_NUM_TEST]
 
    print("training file size:",len(training_file_names))
    print("validation file size:", len(validation_file_names))
 
    # make output file if not existed
    if not os.path.exists(train_filename):
        os.mknod(train_filename)
 
    if not os.path.exists(validation_filename):
        os.mknod(validation_filename)
 
    # write to file
    fo = open(train_filename, "w")
    fo.write("\n".join(training_file_names))
    fo.close()
 
    fo = open(validation_filename, "w")
    fo.write("\n".join(validation_file_names))
    fo.close()
 
    # print process
    print("Written file is: ", train_filename)  

```
  
```python
# 将原数据集分为training ,validation  by gavin
import os
import random
 
import argparse
 
#划分验证集训练集
_NUM_TEST = 20000
 
# parser = argparse.ArgumentParser()
# parser.add_argument('--folder_path', default='../input/celeba-dataset/img_align_celeba/img_align_celeba', type=str,
#                     help='The folder path')
# parser.add_argument('--train_filename', default='./data/celeba/train_shuffled.flist', type=str,
#                     help='The train filename.')
# parser.add_argument('--validation_filename', default='./data/celeba/validation_static_view.flist', type=str,
#                     help='The validation filename.')
 
folder_path = '../input/celeba-dataset/img_align_celeba/img_align_celeba'
train_filename = './data/celeba/train_shuffled.flist'
validation_filename = './data/celeba/validation_static_view.flist'
    
 
def _get_filenames(dataset_dir):
    photo_filenames = []
    image_list = os.listdir(dataset_dir)
    photo_filenames = [os.path.join(dataset_dir, _) for _ in image_list]
    return photo_filenames
 
 
if __name__ == "__main__":
 
#     args = parser.parse_args()
 
#     data_dir = args.folder_path
    data_dir = folder_path
 
    # get all file names
    photo_filenames = _get_filenames(data_dir)
    print("size of celeba is %d" % (len(photo_filenames)))
 
    # 切分数据为测试训练集
    random.seed(0)
    random.shuffle(photo_filenames)
    training_file_names = photo_filenames[_NUM_TEST:]
    validation_file_names = photo_filenames[:_NUM_TEST]
 
    print("training file size:",len(training_file_names))
    print("validation file size:", len(validation_file_names))
 
    # make output file if not existed
    if not os.path.exists(train_filename):
        os.mknod(train_filename)
 
    if not os.path.exists(validation_filename):
        os.mknod(validation_filename)
 
    # write to file
    fo = open(train_filename, "w")
    fo.write("\n".join(training_file_names))
    fo.close()
 
    fo = open(validation_filename, "w")
    fo.write("\n".join(validation_file_names))
    fo.close()
 
    # print process
    print("Written file is: ", train_filename)  
```
  
  
  
  
  
  
  
  

# 预期结果

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  

# bottom